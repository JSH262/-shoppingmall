<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="Cart">

	<insert id="insert" parameterType="CartVO">		
		insert into cart(userId, productId, amount)
		values(#{userId}, #{productId}, #{amount})
	</insert>
	
	<select id="selectList" parameterType="CartVO" resultType="CartVO">
	    SELECT c.user_id, c.product_id, c.amount, p.thumbnail, p.name as product_Name, p.delivery_price, 
		(select company.name from company, users where company.id = users.company_id and users.id = p.seller_id) as company_name,
		to_char(price - price * (discount / 100), 'FM999,999,999') || 'Ïõê' discount_price
		FROM cart c
		JOIN product p ON c.product_id = p.id
		where c.user_id = #{userId}
	</select>
	
	<select id="count" parameterType="java.lang.String" resultType="java.lang.Integer">
	  SELECT COUNT(*) AS count
	  FROM cart
	  WHERE user_id = #{userId}
	</select>
	
	<update id="update" parameterType="CartVO">
		update cart
		set	amount = #{amount}			
		where user_id = #{userId} and product_id = #{productId}
	</update>
		
	<delete id="delete" parameterType="CartVO">
		delete 
		from cart
		where user_id = #{userId} and product_id = #{productId}
	</delete>
		
</mapper>




